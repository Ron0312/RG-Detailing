---
import { Phone, Calculator, MessageCircle } from 'lucide-react';
import { siteConfig } from '../config/site';
---
<div id="mobile-sticky-bar" class="fixed bottom-0 left-0 right-0 z-[100] bg-zinc-950/95 backdrop-blur-xl border-t border-white/10 px-4 py-3 md:hidden flex justify-between items-center safe-area-bottom shadow-[0_-5px_20px_rgba(0,0,0,0.5)] translate-y-[150%] transition-transform duration-500">
    <a href={`tel:${siteConfig.company.contact.phone}`} class="flex flex-col items-center gap-1 text-zinc-400 hover:text-white transition-colors active:scale-95 w-16">
        <Phone size={22} strokeWidth={1.5} />
        <span class="text-[9px] font-bold uppercase tracking-wider">Anrufen</span>
    </a>

    <a href={siteConfig.company.contact.whatsapp} target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 bg-[#25D366] text-white px-6 py-2.5 rounded-full font-bold shadow-[0_0_15px_rgba(37,211,102,0.3)] hover:bg-[#20bd5a] transition-all active:scale-95 -translate-y-4 border border-white/10">
        <MessageCircle size={20} fill="currentColor" />
        <span>WhatsApp</span>
    </a>

    <a href="/#rechner" class="flex flex-col items-center gap-1 text-zinc-400 hover:text-white transition-colors active:scale-95 w-16">
        <Calculator size={22} strokeWidth={1.5} />
        <span class="text-[9px] font-bold uppercase tracking-wider">Preis</span>
    </a>
</div>

<style>
    /* Ensure content isn't hidden behind the bar */
    :global(body) {
        padding-bottom: 80px; /* Adjust based on bar height */
    }
    @media (min-width: 768px) {
        :global(body) {
            padding-bottom: 0;
        }
    }

    /* Hide bar when mobile menu is open (body has overflow-hidden) */
    :global(body.overflow-hidden) #mobile-sticky-bar {
        transform: translateY(150%) !important;
    }
</style>

<script>
    const stickyBar = document.getElementById('mobile-sticky-bar');
    let isTicking = false;

    function onScroll() {
        if (!isTicking) {
            requestAnimationFrame(() => {
                updateStickyBar();
                isTicking = false;
            });
            isTicking = true;
        }
    }

    function updateStickyBar() {
        if (!stickyBar) return;

        // Show bar after scrolling past 500px (approx Hero height)
        if (window.scrollY > 500) {
            stickyBar.classList.remove('translate-y-[150%]');
        } else {
            stickyBar.classList.add('translate-y-[150%]');
        }
    }

    window.addEventListener('scroll', onScroll, { passive: true });
    // Initial check
    updateStickyBar();
</script>
